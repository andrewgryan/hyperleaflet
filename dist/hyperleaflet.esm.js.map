{"version":3,"file":"hyperleaflet.esm.js","sources":["../src/Map/tiles.js","../src/Map/events.js","../src/Map/util.js","../src/config.js","../src/Map/map.js","../src/Geometry/geometry-object-handler.js","../src/Geometry/utils.js","../src/Geometry/events.js","../src/Geometry/leaflet-geometry.js","../src/Geometry/hyperleaflet-geometry-handler.js","../src/Geometry/index.js","../src/Map/index.js","../src/hyperleaflet.js"],"sourcesContent":["import { tileLayer } from 'leaflet';\n\nconst tileLayers = {\n  OpenStreetMap: tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {\n    attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n  }),\n  EsriWorldImagery: tileLayer(\n    'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',\n    {\n      attribution:\n        'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',\n    },\n  ),\n};\n\nexport function addTileLayer(newTileLayer) {\n  if (tileLayers[newTileLayer.name]) {\n    console.warn(`Tile layer ${newTileLayer.name} already exists. Skipping.`);\n    return;\n  }\n  tileLayers[newTileLayer.name] = newTileLayer.tile;\n}\n\nexport default tileLayers;\n","function createGenericMapEvent(map, eventName) {\n  const bounds = map.getBounds();\n  const min = bounds.getSouthWest();\n  const max = bounds.getNorthEast();\n  const bboxString = bounds.toBBoxString();\n  const event = new CustomEvent(eventName, {\n    detail: { zoom: map.getZoom(), center: map.getCenter(), bbox: { min, max }, bboxString },\n  });\n  return event;\n}\n\nexport default function setMapEvents(map) {\n  map.on('click', (e) => {\n    const event = new CustomEvent('map:click', { detail: { point: e.latlng } });\n    window.dispatchEvent(event);\n  });\n\n  map.whenReady(() => {\n    const event = createGenericMapEvent(map, 'map:load');\n    window.dispatchEvent(event);\n  });\n\n  map.on('zoomend', () => {\n    const event = createGenericMapEvent(map, 'map:zoom');\n    window.dispatchEvent(event);\n  });\n\n  map.on('move', () => {\n    const event = createGenericMapEvent(map, 'map:move');\n    window.dispatchEvent(event);\n  });\n\n  return map;\n}\n\nexport function sendHyperleafletReady(map) {\n  const event = createGenericMapEvent(map, 'hyperleaflet:ready');\n  window.dispatchEvent(event);\n}\n","import { control, TileLayer } from 'leaflet';\nimport tileLayers, { addTileLayer } from './tiles';\n\nexport function createCustomTileLayer(url, { minZoom, maxZoom, tms } = {}) {\n  return new TileLayer(url, { minZoom: minZoom || 0, maxZoom: maxZoom || 18, tms: !!tms });\n}\n\nexport function createTileController(tiles) {\n  return tiles.length ? control.layers(Object.fromEntries(tiles.map(({ name, tile }) => [name, tile]))) : null;\n}\n\nexport function parseTileLayerElement(tileLayerElement) {\n  const { tile, tileUrl, tms, minZoom, maxZoom } = tileLayerElement.dataset;\n  if (tileUrl) {\n    const newTile = createCustomTileLayer(tileUrl, { minZoom, maxZoom, tms: tms === 'true' });\n    addTileLayer({ name: tile, tile: newTile });\n  }\n  const currentTile = tileLayers[tile];\n  if (!currentTile) {\n    // eslint-disable-next-line no-console\n    console.warn(`${tile} is not in: \\n${Object.keys(tileLayers).join('\\n')}`);\n    return null;\n  }\n  currentTile.options.minZoom = minZoom;\n  currentTile.options.maxZoom = maxZoom;\n  return { tile: currentTile, name: tile };\n}\n\nfunction reverseCoordinates(point) {\n  return point.reverse();\n}\n\nexport function safeParsePoint(pointJson, reverse = false) {\n  try {\n    const point = JSON.parse(pointJson);\n    return reverse ? reverseCoordinates(point) : point;\n  } catch (_) {\n    return [0, 0];\n  }\n}\n","const hyperleafletConfig = {\n  reverseOrderAll: false,\n};\nexport default hyperleafletConfig;\n","import { map } from 'leaflet';\nimport TILE_LAYERS from './tiles';\nimport setMapEvents from './events';\nimport { createTileController, parseTileLayerElement, safeParsePoint } from './util';\nimport hyperleafletConfig from '../config';\n\nexport function getDefaultHyperleafletTile(tileLayerElementList) {\n  const defaultTileLayerElement = tileLayerElementList.find((t) => 'defaultTile' in t.dataset);\n  if (defaultTileLayerElement && defaultTileLayerElement.dataset.tile in TILE_LAYERS) {\n    return TILE_LAYERS[defaultTileLayerElement.dataset.tile];\n  }\n  if (tileLayerElementList.length && tileLayerElementList[0].dataset.tile in TILE_LAYERS) {\n    return TILE_LAYERS[tileLayerElementList[0].dataset.tile];\n  }\n  return TILE_LAYERS.OpenStreetMap;\n}\n\nexport function createHyperleafletTiles(tileLayerElementNodeList) {\n  const tileLayerElementList = Array.from(tileLayerElementNodeList);\n  const hyperleafletTiles = tileLayerElementList.map(parseTileLayerElement).filter(Boolean);\n  const defaultHyperleafletTile = getDefaultHyperleafletTile(tileLayerElementList);\n  const tileController = createTileController(hyperleafletTiles);\n  return {\n    defaultHyperleafletTile,\n    tileController,\n  };\n}\n\nexport default function createHyperleafletMap(mapElement) {\n  const { center, zoom, minZoom, maxZoom } = mapElement.dataset;\n  const { reverseOrderAll } = hyperleafletConfig;\n  const mapView = {\n    center: safeParsePoint(center, reverseOrderAll),\n    zoom: zoom || 1,\n  };\n  const leafletMap = map(mapElement, {\n    center: mapView.center,\n    zoom: mapView.zoom,\n    minZoom: minZoom || 0,\n    maxZoom: maxZoom || 18,\n  });\n  return setMapEvents(leafletMap);\n}\n","export default function geometryObjectHandler(){\n  const geometryObjectElement = document.createElement('script');\n  geometryObjectElement.type = 'application/json';\n  geometryObjectElement.setAttribute('data-testid', 'json');\n  geometryObjectElement.innerText = '{}';\n  document.body.appendChild(geometryObjectElement);\n  \n  const geometryObject = JSON.parse(geometryObjectElement.text);\n  const addToGeometryObject = (node) =>  {\n    const { id, geometry, geometryType } = node.dataset;\n    node.removeAttribute('data-geometry');\n    geometryObject[id] = { type: geometryType, coordinates: JSON.parse(geometry) };\n    geometryObjectElement.text = JSON.stringify(geometryObject, null, 2);\n  }\n  const removeFromGeometryObject = (node) => {\n    const { id } = node.dataset;\n    delete geometryObject[id];\n    geometryObjectElement.text = JSON.stringify(geometryObject, null, 2);\n  }\n  return {addToGeometryObject, removeFromGeometryObject}\n}\n","export default function utils(node) {\n  node.removeAttribute('data-geometry');\n}\n","export function setPointEvents(leafletObject, id) {\n  leafletObject.on('click', (e) => {\n    const event = new CustomEvent('geometry:click', {\n      detail: { clickedPoint: e.latlng, geometry: leafletObject.getLatLng(), rowId: id }\n    });\n    window.dispatchEvent(event);\n  });\n}\n\nexport function setPolyGeometryEvents(leafletObject, id) {\n  leafletObject.on('click', (e) => {\n    const event = new CustomEvent('geometry:click', { detail: { clickedPoint: e.latlng, geometry: leafletObject.getLatLngs(), rowId: id } });\n    window.dispatchEvent(event);\n  });\n}\n","import { marker, polyline, polygon, GeoJSON } from 'leaflet';\nimport { setPointEvents, setPolyGeometryEvents } from './events';\nimport hyperleafletConfig from '../config';\n\nconst createPointGeometry = (parsedGeometry, options) => {\n  const { reverseOrderAll, reverseOrder } = options;\n  const isLonLat = reverseOrderAll || (reverseOrder !== undefined)\n  const geometry = isLonLat ? [...parsedGeometry].reverse() : parsedGeometry;\n  const leafletGeometry = marker(geometry);\n  if (options.popup) {\n    leafletGeometry.bindPopup(options.popup);\n  }\n  if (options.tooltip) {\n    leafletGeometry.bindTooltip(options.tooltip);\n  }\n  setPointEvents(leafletGeometry, options.id);\n  return leafletGeometry;\n};\n\nconst createLineGeometry = (parsedGeometry, options) => {\n  const { reverseOrderAll, reverseOrder } = options;\n  const isLonLat = reverseOrderAll || (reverseOrder !== undefined)\n  const geometry = isLonLat ? GeoJSON.coordsToLatLngs(parsedGeometry, 0) : parsedGeometry;\n  const leafletGeometry = polyline(geometry);\n  if (options.popup) {\n    leafletGeometry.bindPopup(options.popup);\n  }\n  if (options.tooltip) {\n    leafletGeometry.bindTooltip(options.tooltip);\n  }\n  setPolyGeometryEvents(leafletGeometry, options.id);\n  return leafletGeometry;\n};\n\nconst createPolygonGeometry = (parsedGeometry, options) => {\n  const { reverseOrderAll, reverseOrder } = options;\n  const isLonLat = reverseOrderAll || (reverseOrder !== undefined)\n  const geometry = isLonLat ? GeoJSON.coordsToLatLngs(parsedGeometry, 1) : parsedGeometry;\n  const leafletGeometry = polygon(geometry);\n  if (options.popup) {\n    leafletGeometry.bindPopup(options.popup);\n  }\n  if (options.tooltip) {\n    leafletGeometry.bindTooltip(options.tooltip);\n  }\n  setPolyGeometryEvents(leafletGeometry, options.id);\n  return leafletGeometry;\n};\n\nconst createGeometry = (geometryType) => (parsedGeometry, options) => {\n  switch (geometryType) {\n    case 'Point':\n      return createPointGeometry(parsedGeometry, options);\n    case 'LineString':\n      return createLineGeometry(parsedGeometry, options);\n    case 'Polygon':\n      return createPolygonGeometry(parsedGeometry, options);\n    default:\n      // eslint-disable-next-line no-console\n      console.warn(`${geometryType} is not supported`);\n      return null;\n  }\n};\n\nexport default function createLeafletObject(row) {\n  const { geometry, popup, tooltip, geometryType, id, reverseOrder } = row;\n  const parsedGeometry = JSON.parse(geometry);\n  const {reverseOrderAll} = hyperleafletConfig;\n  const createGeometryFn = createGeometry(geometryType);\n  return createGeometryFn(parsedGeometry, { popup, tooltip, id, reverseOrderAll, reverseOrder });\n}\n","import createLeafletObject from './leaflet-geometry';\n\nfunction addNodeToHyperleaflet(node, map) {\n  const { dataset } = node;\n  const rowId = dataset.id;\n  // eslint-disable-next-line no-underscore-dangle\n  const leafletLayers = Object.values(map._layers);\n\n  if (leafletLayers.find((layer) => layer.hlID === rowId)) {\n    // eslint-disable-next-line no-console\n    console.error(`%c${rowId}`, 'color:red', 'already exists', node);\n    return;\n  }\n\n  const leafletObject = createLeafletObject({ ...dataset });\n  leafletObject.hlID = rowId;\n  leafletObject.addTo(map);\n}\n\nfunction deleteNodeFromHyperleaflet(node, map) {\n  const rowId = node.dataset.id;\n\n  // eslint-disable-next-line no-underscore-dangle\n  const leafletLayers = Object.values(map._layers);\n  const leafletObject = leafletLayers.find((layer) => layer.hlID === rowId);\n  leafletObject?.remove();\n}\n\nexport default function hyperleafletGeometryHandler(map, { addCallback = () => {}, removeCallback = () => {} }) {\n  const addNoteListToHyperleaflet = (nodes) => {\n    nodes.forEach((node) => {\n      addNodeToHyperleaflet(node, map);\n      addCallback(node);\n    });\n  };\n\n  function removeNodeListToHyperleaflet(nodes) {\n    nodes.forEach((node) => {\n      deleteNodeFromHyperleaflet(node, map);\n      removeCallback(node);\n    });\n  }\n\n  return { addNoteListToHyperleaflet, removeNodeListToHyperleaflet };\n}\n\nexport function diffNodesWithMap(mutations, map) {\n  // eslint-disable-next-line no-underscore-dangle\n  const leafletLayers = Object.values(map._layers);\n  const addList = [];\n  const removeList = [];\n\n  function getAddedNodes(nodes) {\n    nodes.forEach((node) => {\n      if (node.nodeType === 1 && node.matches('[data-id]')) {\n        addList.push(node);\n      }\n      if (node.childNodes.length > 0) {\n        getAddedNodes(node.childNodes);\n      }\n    });\n  }\n\n  function getRemovedNodes(nodes) {\n    nodes.forEach((node) => {\n      if (node.nodeType === 1 && node.matches('[data-id]')) {\n        removeList.push(node);\n      }\n      if (node.childNodes.length > 0) {\n        getRemovedNodes(node.childNodes);\n      }\n    });\n  }\n\n  mutations.forEach((mutation) => {\n    if (mutation.type === 'childList') {\n      getAddedNodes(mutation.addedNodes);\n      getRemovedNodes(mutation.removedNodes);\n    }\n  });\n\n  const filteredRemoveList =\n    removeList.filter((node) => !addList.some((addNode) => addNode.dataset.id === node.dataset.id)) ?? [];\n\n  const filteredAddList =\n    addList.filter((node) => !leafletLayers.some((leafletNode) => leafletNode.hlID === node.dataset.id)) ?? [];\n\n  return { addedNodes: filteredAddList, removedNodes: filteredRemoveList };\n}\n","import geometryObjectHandler from './geometry-object-handler';\nimport removeGeometryAttributes from './utils';\nimport hyperleafletGeometryHandler, { diffNodesWithMap } from './hyperleaflet-geometry-handler';\n\nfunction hyperleafletDataToMap(map) {\n  const hyperleafletDataSource = document.querySelector('[data-hyperleaflet-source]');\n\n  if (!hyperleafletDataSource) return;\n\n  const geometryDisplay = hyperleafletDataSource.dataset.geometryDisplay || 'none';\n\n  let callbackFunctions = {};\n  if (geometryDisplay === 'json') {\n    const { addToGeometryObject, removeFromGeometryObject } = geometryObjectHandler();\n    callbackFunctions = {\n      addCallback: addToGeometryObject,\n      removeCallback: removeFromGeometryObject,\n    };\n  } else if (geometryDisplay === 'remove') {\n    callbackFunctions = {\n      addCallback: removeGeometryAttributes,\n      removeCallback: () => {},\n    };\n  }\n\n  const { addNoteListToHyperleaflet, removeNodeListToHyperleaflet } = hyperleafletGeometryHandler(\n    map,\n    callbackFunctions,\n  );\n\n  map.whenReady(() => {\n    const nodes = hyperleafletDataSource.querySelectorAll('[data-id]');\n    addNoteListToHyperleaflet(nodes);\n  });\n\n  function callback(mutations) {\n    const { addedNodes, removedNodes } = diffNodesWithMap(mutations, map);\n    addNoteListToHyperleaflet(addedNodes);\n    removeNodeListToHyperleaflet(removedNodes);\n  }\n\n  const observer = new MutationObserver(callback);\n\n  observer.observe(hyperleafletDataSource, {\n    childList: true, // observe direct children\n    subtree: true, // and lower descendants too\n    attributeFilter: ['data-id'],\n  });\n}\n\nexport default hyperleafletDataToMap;\n","import createHyperleafletMap, { createHyperleafletTiles } from './map';\nimport hyperleafletDataToMap from '../Geometry/index';\nimport { sendHyperleafletReady } from './events';\nimport hyperleafletConfig from '../config';\n\nfunction createMap() {\n  let initialized = false;\n  function initMap() {\n    const mapContainer = document.querySelector('#map');\n    if (mapContainer && !initialized) {\n      initialized = true;\n      const { reverseOrderAll } = mapContainer.dataset;\n      if (reverseOrderAll !== undefined) {\n        hyperleafletConfig.reverseOrderAll = true;\n      }\n\n      const map = createHyperleafletMap(mapContainer);\n\n      const tileLayerElementList = mapContainer.querySelectorAll('[data-tile]');\n      const { defaultHyperleafletTile, tileController } = createHyperleafletTiles(tileLayerElementList);\n\n      if (tileController) {\n        tileController.addTo(map);\n      }\n      defaultHyperleafletTile.addTo(map);\n      hyperleafletDataToMap(map);\n      window.hyperleaflet = { map };\n      sendHyperleafletReady(map);\n    }\n  }\n\n  function observeMap() {\n    const observer = new MutationObserver(() => {\n      const mapElement = document.querySelector('#map');\n      if (mapElement) {\n        initMap();\n      } else if (initialized) {\n        initialized = false;\n        delete window.hyperleaflet;\n      }\n    });\n    observer.observe(document.documentElement, { childList: true, subtree: true });\n  }\n\n  return { initMap, observeMap };\n}\nexport default createMap;\n","import createMap from './Map';\n\nconst hyperleaflet = (function hyperleaflet() {\n  const { initMap, observeMap } = createMap();\n\n  document.addEventListener('DOMContentLoaded', () => {\n    initMap();\n    observeMap();\n  });\n})();\n\nexport default hyperleaflet;\n"],"names":["tileLayers","OpenStreetMap","tileLayer","attribution","EsriWorldImagery","addTileLayer","newTileLayer","name","console","warn","tile","createGenericMapEvent","map","eventName","bounds","getBounds","min","getSouthWest","max","getNorthEast","bboxString","toBBoxString","event","CustomEvent","detail","zoom","getZoom","center","getCenter","bbox","setMapEvents","on","e","point","latlng","window","dispatchEvent","whenReady","sendHyperleafletReady","createCustomTileLayer","url","minZoom","maxZoom","tms","TileLayer","createTileController","tiles","length","control","layers","Object","fromEntries","parseTileLayerElement","tileLayerElement","dataset","tileUrl","newTile","currentTile","keys","join","options","reverseCoordinates","reverse","safeParsePoint","pointJson","JSON","parse","_","hyperleafletConfig","reverseOrderAll","getDefaultHyperleafletTile","tileLayerElementList","defaultTileLayerElement","find","t","TILE_LAYERS","createHyperleafletTiles","tileLayerElementNodeList","Array","from","hyperleafletTiles","filter","Boolean","defaultHyperleafletTile","tileController","createHyperleafletMap","mapElement","mapView","leafletMap","geometryObjectHandler","geometryObjectElement","document","createElement","type","setAttribute","innerText","body","appendChild","geometryObject","text","addToGeometryObject","node","id","geometry","geometryType","removeAttribute","coordinates","stringify","removeFromGeometryObject","utils","setPointEvents","leafletObject","clickedPoint","getLatLng","rowId","setPolyGeometryEvents","getLatLngs","createPointGeometry","parsedGeometry","reverseOrder","isLonLat","undefined","leafletGeometry","marker","popup","bindPopup","tooltip","bindTooltip","createLineGeometry","GeoJSON","coordsToLatLngs","polyline","createPolygonGeometry","polygon","createGeometry","createLeafletObject","row","createGeometryFn","addNodeToHyperleaflet","leafletLayers","values","_layers","layer","hlID","error","addTo","deleteNodeFromHyperleaflet","remove","hyperleafletGeometryHandler","addCallback","removeCallback","addNoteListToHyperleaflet","nodes","forEach","removeNodeListToHyperleaflet","diffNodesWithMap","mutations","addList","removeList","getAddedNodes","nodeType","matches","push","childNodes","getRemovedNodes","mutation","addedNodes","removedNodes","filteredRemoveList","some","addNode","filteredAddList","leafletNode","hyperleafletDataToMap","hyperleafletDataSource","querySelector","geometryDisplay","callbackFunctions","removeGeometryAttributes","querySelectorAll","callback","observer","MutationObserver","observe","childList","subtree","attributeFilter","createMap","initialized","initMap","mapContainer","hyperleaflet","observeMap","documentElement","addEventListener"],"mappings":"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"}