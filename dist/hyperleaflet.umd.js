!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],t):(e||self).hyperleaflet=t(e.leaflet)}(this,function(e){function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},t.apply(this,arguments)}function o(e,t){e.on("click",function(){var o=new CustomEvent("pointclick",{detail:{point:e.getLatLng(),rowId:t}});window.dispatchEvent(o)})}var n=new Map,r={OpenStreetMap:e.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),EsriWorldImagery:e.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"})},i=document.createElement("script");i.type="application/json",i.setAttribute("data-testid","debug"),i.innerText="{}",document.body.appendChild(i);var a=JSON.parse(i.text);function l(e){var t=e.dataset,o=t.id,n=t.geometry,r=t.geometryType;e.removeAttribute("data-geometry"),a[o]={type:r,coordinates:JSON.parse(n)},i.text=JSON.stringify(a,null,2)}function d(e){delete a[e.dataset.id],i.text=JSON.stringify(a,null,2)}function p(e){e.removeAttribute("data-geometry")}return function(){var i=document.querySelector("#map"),a=function(t){var o,n=t.dataset,r=n.center,i=n.zoom,a={center:null==r?void 0:r.split(","),zoom:i||1},l=e.map(t).setView(a.center,a.zoom);return(o=l).on("click",function(e){var t=new CustomEvent("mapclick",{detail:{point:e.latlng}});window.dispatchEvent(t)}),o.on("zoomend",function(){var e=new CustomEvent("mapzoom",{detail:{zoom:o.getZoom(),center:o.getCenter(),bbox:o.getBounds()}});window.dispatchEvent(e)}),o.on("move",function(){var e=new CustomEvent("mapmove",{detail:{zoom:o.getZoom(),center:o.getCenter(),bbox:o.getBounds()}});window.dispatchEvent(e)}),o}(i),u=document.querySelector("[hyperleaflet]"),c=function(t){var o=Array.from(t),n=o.map(function(e){var t=e.dataset,o=t.tile,n=t.maxZoom,i=r[o];return i?(i.options.minZoom=t.minZoom,i.options.maxZoom=n,i.name=o,{tile:i}):(console.warn(o+" is not in: \n"+Object.keys(r).join("\n")),null)}).filter(Boolean),i=function(e){var t=e.find(function(e){return"defaultTile"in e.dataset});return t?r[t.dataset.tile]:e.length?r[e[0].dataset.tile]:r.OpenStreetMap}(o);return{defaultHyperleafletTile:i,tileController:n.length?e.control.layers(Object.fromEntries(n.map(function(e){return[e.tile.name,e.tile]}))):null}}(i.querySelectorAll("[data-tile]")),s=c.defaultHyperleafletTile,f=c.tileController;f&&f.addTo(a),s.addTo(a);var m=u.dataset.geometryDisplay||"object",y={};"object"===m?y={addCallback:l,removeCallback:d}:"remove"===m&&(y={addCallback:p,removeCallback:function(){}});var v=function(r,i){var a=i.addCallback,l=void 0===a?function(){}:a,d=i.removeCallback,p=void 0===d?function(){}:d;return{addNoteListToHyperleaflet:function(i){i.forEach(function(i){1===i.nodeType&&i.matches("[data-id]")&&(function(r){var i=r.dataset,a=i.id;if(a in n)return console.error("%c"+a,"color:red","already exists",r),[];var l,d,p,u,c,s,f=(d=(l=t({},i)).popup,p=l.tooltip,u=l.geometryType,c=l.id,s=JSON.parse(l.geometry),function(t){return function(n,r){switch(t){case"Point":return function(t,n){var r=e.marker(t);return n.popup&&r.bindPopup(n.popup),n.tooltip&&r.bindTooltip(n.tooltip),o(r,n.id),r}(n,r);case"LineString":return function(t,n){var r=e.GeoJSON.coordsToLatLngs(t,1),i=e.polyline(r);return n.popup&&i.bindPopup(n.popup),n.tooltip&&i.bindTooltip(n.tooltip),o(i,n.id),i}(n,r);case"Polygon":return function(t,n){var r=e.GeoJSON.coordsToLatLngs(t,1),i=e.polygon(r);return n.popup&&i.bindPopup(n.popup),n.tooltip&&i.bindTooltip(n.tooltip),o(i,n.id),i}(n,r);default:return console.warn(t+" is not supported"),null}}}(u)(s,{popup:d,tooltip:p,id:c}));return n.set(a,f),[f]}(i)[0].addTo(r),l(i))})},removeNodeListToHyperleaflet:function(e){e.forEach(function(e){if(1===e.nodeType&&e.matches("[data-id]")){var t=function(e){var t=e.dataset.id,o=n.get(t);return n.delete(t),[o]}(e);t[0].remove(),p(e)}})}}}(a,y),g=v.addNoteListToHyperleaflet,b=v.removeNodeListToHyperleaflet;return a.whenReady(function(){var e=u.querySelectorAll("[data-id]");g(e)}),new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&(g(e.addedNodes),b(e.removedNodes))})}).observe(u,{childList:!0,subtree:!0,attributeFilter:["data-id"]}),{map:a,addGeoJsonToMap:function(t){e.geoJSON(t).addTo(a)}}}()});
//# sourceMappingURL=hyperleaflet.umd.js.map
