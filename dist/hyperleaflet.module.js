import e from"leaflet";import{defineExtension as t}from"htmx.org";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},n.apply(this,arguments)}var o={OpenStreetMap:e.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),EsriWorldImagery:e.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"})},r=function(){if(void 0!==e){var r=document.querySelector("#map"),a=r.querySelectorAll("[data-tile]"),i={center:[0,0],zoom:1,tile:o.OpenStreetMap},l=r.dataset,c=(null==l?void 0:l.center.split(","))||i.center.center,d=(null==l?void 0:l.zoom)||i.zoom,s=i.tile,m={};a.forEach(function(e){var t=e.dataset,n=t.tile;if(n in o){var r=o[n];r.options.minZoom=t.minZoom,r.options.maxZoom=t.maxZoom,m[n]=r,"default"in t&&(s=r)}else console.warn(n+" is not in: \n"+Object.keys(o).join("\n"))});var u=e.map(r).setView(c,d);!function(e){e.on("click",function(e){var t=document.getElementById("map"),n=new CustomEvent("mapclick",{detail:{latlng:e.latlng}});t.dispatchEvent(n)}),e.on("zoomend",function(){var t=document.getElementById("map"),n=new CustomEvent("mapzoom",{detail:{zoom:e.getZoom()}});t.dispatchEvent(n)}),e.on("move",function(){var t=document.getElementById("map"),n=new CustomEvent("mapmove",{detail:{bbox:e.getBounds(),center:e.getCenter()}});t.dispatchEvent(n)})}(u),Object.keys(m).length&&e.control.layers(m).addTo(u),s.addTo(u);var p={},f=new Proxy(p,{set:function(t,n,o){var r=e.marker(o.split(",")).addTo(u);return function(e,t){e.on("click",function(e){var n=document.getElementById("map"),o=new CustomEvent("pointclick",{detail:{latlng:e.latlng,rowId:t}});n.dispatchEvent(o)})}(r,n),t[n]=r,!0},deleteProperty:function(e,t){return e[t].remove(),delete e[t],!0}});return t("leaflet",{onEvent:function(e){var t,o,r,a,i,l;["htmx:afterProcessNode","htmx:afterOnLoad"].includes(e)&&(a=document.querySelector("[hx-ext=leaflet]").querySelectorAll("[data-id]"),t=i=Array.from(a).reduce(function(e,t){var o;return n({},e,((o={})[t.dataset.id]=t.dataset.latlng,o))},{}),o=Object.keys(p),(l={adds:(r=Object.keys(t)).filter(function(e){return!o.includes(e)}),deletes:o.filter(function(e){return!r.includes(e)})}).adds.forEach(function(e){f[e]=i[e]}),l.deletes.forEach(function(e){delete f[e]}))}}),{map:u}}console.error("Hyperleaf can not access Leaflet")}();export{r as default};
//# sourceMappingURL=hyperleaflet.module.js.map
