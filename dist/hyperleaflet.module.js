import e from"leaflet";function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},t.apply(this,arguments)}function o(e,t){e.on("click",function(){var o=new CustomEvent("pointclick",{detail:{point:e.getLatLng(),rowId:t}});window.dispatchEvent(o)})}var n=new Map,r={OpenStreetMap:e.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),EsriWorldImagery:e.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"})},a=document.createElement("script");a.type="application/json",a.setAttribute("data-testid","debug"),a.innerText="{}",document.body.appendChild(a);var i=JSON.parse(a.text);function l(e){var t=e.dataset,o=t.id,n=t.geometry,r=t.geometryType;e.removeAttribute("data-geometry"),i[o]={type:r,coordinates:JSON.parse(n)},a.text=JSON.stringify(i,null,2)}function d(e){delete i[e.dataset.id],a.text=JSON.stringify(i,null,2)}function p(e){e.removeAttribute("data-geometry")}var c=function(){if(void 0!==e){var a=document.querySelector("#map"),i=function(t){var o,n=t.dataset,r=n.center,a=n.zoom,i={center:null==r?void 0:r.split(","),zoom:a||1};return(o=e.map(t).setView(i.center,i.zoom)).on("click",function(e){var t=new CustomEvent("mapclick",{detail:{point:e.latlng}});window.dispatchEvent(t)}),o.on("zoomend",function(){var e=new CustomEvent("mapzoom",{detail:{zoom:o.getZoom(),center:o.getCenter(),bbox:o.getBounds()}});window.dispatchEvent(e)}),o.on("move",function(){var e=new CustomEvent("mapmove",{detail:{zoom:o.getZoom(),center:o.getCenter(),bbox:o.getBounds()}});window.dispatchEvent(e)}),o}(a),c=document.querySelector("[hyperleaflet]"),u=function(t){var o,n=Array.from(t),a=n.map(function(e){var t=e.dataset,o=t.tile,n=t.maxZoom,a=r[o];return a?(a.options.minZoom=t.minZoom,a.options.maxZoom=n,a.name=o,{tile:a}):(console.warn(o+" is not in: \n"+Object.keys(r).join("\n")),null)}).filter(Boolean),i=null==(o=n.find(function(e){return"defaultTile"in e.dataset}))?void 0:o.dataset.tile,l=r[i];return{defaultHyperleafletTile:null!=l?l:r.OpenStreetMap,tileController:a.length?e.control.layers(Object.fromEntries(a.map(function(e){return[e.tile.name,e.tile]}))):null}}(a.querySelectorAll("[data-tile]")),s=u.defaultHyperleafletTile,m=u.tileController;m&&m.addTo(i),s.addTo(i);var f=c.dataset.geometryDisplay||"object",v={};"object"===f?v={addCallback:l,removeCallback:d}:"remove"===f&&(v={addCallback:p,removeCallback:function(){}});var y=function(r,a){var i=a.addCallback,l=void 0===i?function(){}:i,d=a.removeCallback,p=void 0===d?function(){}:d;return{addNoteListToHyperleaflet:function(a){a.forEach(function(a){1===a.nodeType&&a.matches("[data-id]")&&(function(r){var a=r.dataset,i=a.id;if(i in n)return console.error("%c"+i,"color:red","already exists",r),[];var l,d,p,c,u,s,m=(d=(l=t({},a)).popup,p=l.tooltip,c=l.geometryType,u=l.id,s=JSON.parse(l.geometry),function(t){return function(n,r){switch(t){case"Point":return function(t,n){var r=e.marker(t);return n.popup&&r.bindPopup(n.popup),n.tooltip&&r.bindTooltip(n.tooltip),o(r,n.id),r}(n,r);case"LineString":return function(t,n){var r=e.GeoJSON.coordsToLatLngs(t,1),a=e.polyline(r);return n.popup&&a.bindPopup(n.popup),n.tooltip&&a.bindTooltip(n.tooltip),o(a,n.id),a}(n,r);case"Polygon":return function(t,n){var r=e.GeoJSON.coordsToLatLngs(t,1),a=e.polygon(r);return n.popup&&a.bindPopup(n.popup),n.tooltip&&a.bindTooltip(n.tooltip),o(a,n.id),a}(n,r);default:return console.warn(t+" is not supported"),null}}}(c)(s,{popup:d,tooltip:p,id:u}));return n.set(i,m),[m]}(a)[0].addTo(r),l(a))})},removeNodeListToHyperleaflet:function(e){e.forEach(function(e){if(1===e.nodeType&&e.matches("[data-id]")){var t=function(e){var t=e.dataset.id,o=n.get(t);return n.delete(t),[o]}(e);t[0].remove(),p(e)}})}}}(i,v),g=y.addNoteListToHyperleaflet,b=y.removeNodeListToHyperleaflet;return i.whenReady(function(){var e=c.querySelectorAll("[data-id]");g(e)}),new MutationObserver(function(e){e.forEach(function(e){"childList"===e.type&&(g(e.addedNodes),b(e.removedNodes))})}).observe(c,{childList:!0,subtree:!0,attributeFilter:["data-id"]}),{map:i,addGeoJsonToMap:function(t){e.geoJSON(t).addTo(i)}}}console.error("Hyperleaflet can not access Leaflet")}();export{c as default};
//# sourceMappingURL=hyperleaflet.module.js.map
