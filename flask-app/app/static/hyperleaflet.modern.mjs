import e from"leaflet";import{defineExtension as t}from"htmx.org";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},r.apply(this,arguments)}const o={OpenStreetMap:e.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),EsriWorldImagery:e.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"})},n=function(){if(void 0===e)return void console.error("Can't access Leaflet");const n=document.querySelector("#map"),a=n.querySelectorAll("[data-tile]"),s={center:[0,0],zoom:1,tile:o.OpenStreetMap},{dataset:i}=n,l=(null==i?void 0:i.center.split(","))||s.center.center,c=(null==i?void 0:i.zoom)||s.zoom;let{tile:d}=s;const p={};a.forEach(e=>{const{dataset:t}=e,r=t.tile;if(r in o){const e=o[r];e.options.minZoom=t.minZoom,e.options.maxZoom=t.maxZoom,p[r]=e,"default"in t&&(d=e)}else console.warn(`${r} is not in: \n${Object.keys(o).join("\n")}`)});const m=e.map(n).setView(l,c);Object.keys(p).length&&e.control.layers(p).addTo(m),d.addTo(m);const u={},y=new Proxy(u,{set(t,r,o){const n=e.marker(o.split(",")).addTo(m);return t[r]=n,!0},deleteProperty:(e,t)=>(e[t].remove(),delete e[t],!0)});return t("leaflet",{onEvent:e=>{["htmx:afterProcessNode","htmx:afterOnLoad"].includes(e)&&(e=>{const t=document.querySelector("[hx-ext=leaflet]").querySelectorAll("[data-id]"),o=Array.from(t).reduce((e,t)=>r({},e,{[t.dataset.id]:t.dataset.latlng}),{}),n=((e,t)=>{const r=Object.keys(e),o=Object.keys(t);return{adds:o.filter(e=>!r.includes(e)),deletes:r.filter(e=>!o.includes(e))}})(u,o);n.adds.forEach(e=>{y[e]=o[e]}),n.deletes.forEach(e=>{delete y[e]})})()}}),{map:m}}();export{n as default};
//# sourceMappingURL=hyperleaflet.modern.mjs.map
